NEOTERIC_BUILD_DATE := $(shell date -u +%Y%m%d)

NEOTERIC_TARGET := Neoteric-OS_$(TARGET_DEVICE)-$(NEOTERIC_VERSION)-$(NEOTERIC_BUILD_DATE)

SHA256 := prebuilts/build-tools/path/$(HOST_PREBUILT_TAG)/sha256sum

NEOTERIC_OTA_PACKAGE := $(PRODUCT_OUT)/$(NEOTERIC_TARGET).zip

$(NEOTERIC_OTA_PACKAGE): $(BUILT_TARGET_FILES_PACKAGE) $(OTA_FROM_TARGET_FILES)
	$(call build-ota-package-target,$@,-k $(SIGNING_KEYS) --output_metadata_path $(INTERNAL_OTA_METADATA))

.PHONY: bacon
bacon: $(NEOTERIC_OTA_PACKAGE)
	$(hide) $(SHA256) $(NEOTERIC_OTA_PACKAGE) | sed "s|$(PRODUCT_OUT)/||" > $(NEOTERIC_OTA_PACKAGE).sha256sum
	$(hide) ./vendor/neoteric/tools/generate_json_build_info.sh $(NEOTERIC_OTA_PACKAGE)
	@echo "Package Complete: $(NEOTERIC_OTA_PACKAGE)" >&2

NEOTERIC_FASTBOOT_PACKAGE := $(PRODUCT_OUT)/$(NEOTERIC_TARGET)-fastboot.zip

$(NEOTERIC_FASTBOOT_PACKAGE): $(BUILT_TARGET_FILES_PACKAGE) $(IMG_FROM_TARGET_FILES)
	$(IMG_FROM_TARGET_FILES) \
	$(BUILT_TARGET_FILES_PACKAGE) $@

.PHONY: fastboot
fastboot: $(NEOTERIC_FASTBOOT_PACKAGE)
	$(hide) $(SHA256) $(NEOTERIC_FASTBOOT_PACKAGE) | sed "s|$(PRODUCT_OUT)/||" > $(NEOTERIC_FASTBOOT_PACKAGE).sha256sum
	@echo "Package Complete: $(NEOTERIC_FASTBOOT_PACKAGE)" >&2 
