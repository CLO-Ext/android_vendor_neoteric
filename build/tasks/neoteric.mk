NEOTERIC_DATE_YEAR := $(shell date -u +%Y)
NEOTERIC_DATE_MONTH := $(shell date -u +%m)
NEOTERIC_DATE_DAY := $(shell date -u +%d)
NEOTERIC_DATE_HOUR := $(shell date -u +%H)
NEOTERIC_DATE_MINUTE := $(shell date -u +%M)
NEOTERIC_BUILD_DATE := $(NEOTERIC_DATE_YEAR)$(NEOTERIC_DATE_MONTH)$(NEOTERIC_DATE_DAY)-$(NEOTERIC_DATE_HOUR)$(NEOTERIC_DATE_MINUTE)

NEOTERIC_TARGET := $(PRODUCT_OUT)/Neoteric-OS_$(TARGET_DEVICE)-$(NEOTERIC_VERSION)-$(NEOTERIC_BUILD_DATE)

SHA256 := prebuilts/build-tools/path/$(HOST_PREBUILT_TAG)/sha256sum

OTA_PACKAGE := $(PRODUCT_OUT)/Neoteric-OS_$(TARGET_DEVICE)-$(NEOTERIC_VERSION)-$(NEOTERIC_BUILD_DATE).zip
NEOTERIC_OTA_PACKAGE := $(OTA_PACKAGE)

$(OTA_PACKAGE): $(BUILT_TARGET_FILES_PACKAGE) $(OTA_FROM_TARGET_FILES)
	$(call build-ota-package-target,$@,-k $(SIGNING_KEYS) --output_metadata_path $(INTERNAL_OTA_METADATA))

.PHONY: bacon
bacon: $(OTA_PACKAGE)
	$(hide) $(SHA256) $(NEOTERIC_OTA_PACKAGE) | sed "s|$(PRODUCT_OUT)/||" > $(NEOTERIC_OTA_PACKAGE).sha256sum
	@echo "Package Complete: $(NEOTERIC_OTA_PACKAGE)" >&2

FASTBOOT_PACKAGE := $(PRODUCT_OUT)/$(NEOTERIC_TARGET)-fastboot.zip
NEOTERIC_FASTBOOT_PACKAGE := $(FASTBOOT_PACKAGE)

$(FASTBOOT_PACKAGE): $(BUILT_TARGET_FILES_PACKAGE) $(IMG_FROM_TARGET_FILES)
	$(IMG_FROM_TARGET_FILES) \
	$(BUILT_TARGET_FILES_PACKAGE) $@

.PHONY: fastboot
fastboot: $(FASTBOOT_PACKAGE)
	$(hide) $(SHA256) $(NEOTERIC_FASTBOOT_PACKAGE) | sed "s|$(PRODUCT_OUT)/||" > $(NEOTERIC_FASTBOOT_PACKAGE).sha256sum
	@echo "Package Complete: $(NEOTERIC_FASTBOOT_PACKAGE)" >&2 
